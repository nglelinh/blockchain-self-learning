---
layout: post
title: "Lecture 07.03: MEV - Maximal Extractable Value"
chapter: '07'
order: 4
owner: Blockchain Course Team
lang: vi
categories:
- blockchain-chapter07
---

# Lecture: MEV - Maximal Extractable Value

## 1. Concept Overview

MEV (Maximal Extractable Value, formerly "Miner Extractable Value") ƒë·∫°i di·ªán cho profit m√† validators/miners c√≥ th·ªÉ extract th√¥ng qua ability reorder, include, ho·∫∑c exclude transactions trong blocks they produce. Phenomenon n√†y arose t·ª´ transparent mempool c·ªßa Ethereum v√† deterministic execution c·ªßa smart contracts, enabling sophisticated actors preview transaction effects v√† manipulate ordering for profit, often at expense c·ªßa regular users.

MEV discovered v√† formalized b·ªüi **Phil Daian v√† colleagues** trong paper "Flash Boys 2.0" nƒÉm 2019, drawing parallels v·ªõi high-frequency trading trong traditional finance. Research showed billions of dollars extracted annually through techniques nh∆∞ front-running, back-running, v√† sandwich attacks, raising concerns v·ªÅ fairness, decentralization, v√† protocol stability.

---

## 2. Intuitive Understanding

MEV comparable to insider trading tr√™n stock market. Imagine seeing everyone's orders before they execute, ability prioritize your own trades, v√† capacity rearrange order flow for maximum personal profit. Traditional finance heavily regulates n√†y. Blockchain mempool inherently transparent - all pending transactions visible - creating MEV opportunities structurally embedded trong protocol design.

---

## 3. Technical Foundation

Sandwich attack exemplifies MEV extraction. Bot detects large DEX trade trong mempool, front-runs b·∫±ng c√°ch buying before victim (increasing price), victim's trade executes at worse price, bot back-runs selling at profit.

```python
class MEVBot:
    def detect_opportunity(self, pending_tx):
        if pending_tx['type'] == 'DEX_SWAP' and pending_tx['amount'] > threshold:
            # Large trade detected - sandwich opportunity
            return self.execute_sandwich(pending_tx)
    
    def execute_sandwich(self, victim_tx):
        # Front-run: Buy before victim
        front_run_tx = create_buy_tx(
            amount=optimal_amount,
            gas_price=victim_tx.gas_price + 1  # Higher priority
        )
        
        # Victim tx executes (price increases)
        
        # Back-run: Sell after victim  
        back_run_tx = create_sell_tx(
            amount=front_run_amount,
            gas_price=victim_tx.gas_price - 1  # Still processes
        )
        
        # Profit = (price_after - price_before) * amount - gas_costs
```

---

## 4. Mathematical / Cryptographic Formulation

MEV extraction quantified as:

\[
\text{MEV} = \max_{o \in O} R(o) - R(o_{\text{default}})
\]

Where \(O\) = set c·ªßa possible transaction orderings, \(R(o)\) = revenue under ordering \(o\).

Sandwich attack profit:

\[
\Pi = (P_{\text{after}} - P_{\text{before}}) \times Q - \text{Gas}
\]

Example: Victim buys 100 ETH on Uniswap, bot sandwiches:
- Front-run 50 ETH: Price $2000 ‚Üí $2020
- Victim 100 ETH: Price $2020 ‚Üí $2060  
- Back-run 50 ETH: Sell at $2060

Profit: 50 √ó ($2060 - $2000) - gas ‚âà $3,000

---

## 5. Implementation Insight

**Flashbots** mitigates MEV through sealed-bid auctions:

```python
# Instead of public mempool, private transaction bundles
bundle = {
    'transactions': [front_run_tx, victim_tx, back_run_tx],
    'block_number': target_block,
    'bribe': 0.1 ETH  # Paid to validator
}

# Submit directly to validator
# No public mempool exposure
# Reduces harmful MEV (though doesn't eliminate)
```

---

## 6. Common Challenges / Attacks / Trade-offs

MEV creates centralization pressure - sophisticated infrastructure required, favoring large operators. Estimated $600M+ extracted annually, mostly by small number of entities. Threatens decentralization v√† fairness.

---

## 7. Related Concepts

**MEV-Boost** enables validators outsource block building to specialized builders, separating proposing from building. Increases MEV extraction efficiency whilst maintaining decentralization of proposal rights.

---

## 8. ‚≠ê Fundamental Papers / Whitepapers

| Paper | Year | Author(s) | Contribution |
|-------|------|-----------|--------------|
| **"Flash Boys 2.0: Frontrunning, Transaction Reordering, and Consensus Instability in Decentralized Exchanges"** | 2019 | Daian et al. | MEV formalization |
| **"Flashbots: Frontrunning the MEV Crisis"** | 2020 | Flashbots team | MEV mitigation approach |

---

## 9. üé® Illustrations & Visual References

![MEV Extraction Flow](https://docs.flashbots.net/img/mev-extraction.png)  
*Source: [Flashbots Documentation](https://docs.flashbots.net/)*

---

## 10. Summary

MEV represents billions extracted through transaction ordering manipulation. While some MEV unavoidable (arbitrage beneficial for efficiency), harmful MEV (sandwich attacks) damages user experience v√† fairness. Solutions like Flashbots, encrypted mempools, v√† fair ordering protocols attempt mitigate whilst preserving validator economics. Understanding MEV essential for protocol designers, traders, v√† anyone interacting with DeFi.

---

‚úÖ **End of Lecture**

Next: Lecture 07.04 - Quantum Resistance Strategies

---

## References

1. Daian, P., et al. (2019). *Flash Boys 2.0*. IEEE S&P 2020.
2. Flashbots. (2020). *Flashbots Documentation*. https://docs.flashbots.net/

